<script lang="ts">
    import type { Content, Tool } from '$shared/types'
    import { selectedSkills, visibleItems } from '$lib/stores'
    import ToolPreview from './ToolPreview.svelte'
    import Button from './Button.svelte'
    import Link from './Link.svelte'
    import { SUGGEST_NEW_TOOL_LINK } from '$lib/constants'
    import TopPick from './TopPick.svelte'

    export let tools: Tool[]
    export let content: Content

    const resetSkills = () => {
        $selectedSkills = []
    }

    const showMore = () => {
        $visibleItems += 10
    }
</script>

{#each tools.slice(0, $visibleItems) as tool, index (tool.link)}
    {#if index === 0}
        <TopPick {tool} {content} />
    {:else}
        <ToolPreview {tool} {content} />
    {/if}
{:else}
    <div class="flex flex-col items-center space-y-4">
        <p>
            No published tools for these skills yet. Welcome to
            <Link href={SUGGEST_NEW_TOOL_LINK} variant="pink"
                >suggest new tools here</Link
            >!
        </p>
        <Button on:click={resetSkills}>View all tools</Button>
    </div>
{/each}

<div
    class="col-span-2 flex flex-col items-center justify-center space-y-4 pt-16"
>
    {#if $visibleItems < tools.length}
        <Button on:click={showMore}>Show more</Button>
    {:else}
        {#if $selectedSkills.length}
            <Button on:click={resetSkills}>View all tools</Button>
        {/if}
        {#if tools.length}
            <p>
                Welcome to <Link href={SUGGEST_NEW_TOOL_LINK} variant="pink"
                    >suggest new tools here</Link
                >!
            </p>
        {/if}
    {/if}
</div>
